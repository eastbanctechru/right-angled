"use strict";(self.webpackChunkright_angled_demo=self.webpackChunkright_angled_demo||[]).push([[6],{3006:(S,n,s)=>{s.r(n),s.d(n,{PersistenceModule:()=>q});var c=s(6814),l=s(5500),p=s(9664),e=s(2029),h=s(6161),Z=s(9135),m=s(804),a=s(2350),r=s(9504),U=s(5718),T=s(4486);function A(t,y){if(1&t&&(e.TgZ(0,"tr",10)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA()()),2&t){const o=y.$implicit;e.Q6J("rtSelectable",o),e.xp6(2),e.Oqu(o.iataCode),e.xp6(2),e.Oqu(o.name),e.xp6(2),e.Oqu(o.cityName),e.xp6(2),e.Oqu(o.countryName)}}let f=(()=>{class t{constructor(o){this.airportsService=o,this.loadData=i=>this.airportsService.getAirportsPagedList(i)}static#e=this.\u0275fac=function(i){return new(i||t)(e.Y36(r.Gy))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["rt-demo-persistence-sample"]],features:[e._Bn([{provide:a.Yi,useClass:r.jU,multi:!0},{provide:a.Yi,useClass:r.rZ,multi:!0},{provide:a.Yi,useClass:r.jz,multi:!0}])],decls:26,vars:9,consts:[[3,"rtList","loadOnInit"],["list","rtList"],[3,"list","rtRegisterAsFilter"],["filter",""],[1,"table-responsive"],[1,"table","table-striped"],[3,"rtSort"],["rtSelectionArea",""],[3,"rtSelectable",4,"ngFor","ngForOf"],["colspan","4"],[3,"rtSelectable"]],template:function(i,d){if(1&i&&(e.TgZ(0,"div",0,1),e._UZ(2,"rt-demo-filter-area",2,3),e.TgZ(4,"div",4)(5,"table",5)(6,"thead")(7,"tr")(8,"th")(9,"span",6),e._uU(10,"IATA"),e.qZA()(),e.TgZ(11,"th")(12,"span",6),e._uU(13,"Airport name"),e.qZA()(),e.TgZ(14,"th")(15,"span",6),e._uU(16,"City"),e.qZA()(),e.TgZ(17,"th")(18,"span",6),e._uU(19,"Country"),e.qZA()()()(),e.TgZ(20,"tbody",7),e.YNc(21,A,9,5,"tr",8),e.qZA(),e.TgZ(22,"tfoot")(23,"tr")(24,"td",9),e._UZ(25,"rt-demo-paged-footer"),e.qZA()()()()()()),2&i){const g=e.MAs(1),b=e.MAs(3);e.Q6J("rtList",d.loadData)("loadOnInit",!1),e.xp6(2),e.Q6J("list",g)("rtRegisterAsFilter",b),e.xp6(7),e.Q6J("rtSort","iataCode"),e.xp6(3),e.Q6J("rtSort","name"),e.xp6(3),e.Q6J("rtSort","cityName"),e.xp6(3),e.Q6J("rtSort","countryName"),e.xp6(3),e.Q6J("ngForOf",g.items)}},dependencies:[c.sg,a.lo,a.bk,a.hE,a.LF,a.n8,U.S,T.h],encapsulation:2,changeDetection:0})}return t})();const u=function(){return["/filters"]},v=function(){return["/misc-directives"]},_=[{component:(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["ng-component"]],decls:219,vars:6,consts:[[1,"agenda"],["href","persistence#common-idea"],["href","persistence#service-implementations"],["href","persistence#service-usage"],["href","persistence#concrete-component"],["href","persistence#global-registration"],["id","common-idea"],["href","#",3,"routerLink"],[1,"bulleted"],["id","service-implementations"],["title","local-storage-state-service.ts","url","shared/state-services/local-storage-state-service.ts"],["title","session-storage-state-service.ts","url","shared/state-services/session-storage-state-service.ts"],["title","query-string-state-service.ts","url","shared/state-services/query-string-state-service.ts"],["target","_blank","href","https://angular.io/docs/ts/latest/api/router/index/ActivatedRoute-interface.html"],["target","_blank","href","https://angular.io/docs/ts/latest/api/core/index/OpaqueToken-class.html"],["id","service-usage"],["id","concrete-component"],["url","persistence/persistence-sample/persistence-sample.component.html"],["url","persistence/persistence-sample/persistence-sample.component.ts"],["id","global-registration"],["title","app.module.ts","url","persistence/bootstrap/app.module.tsfake"],["href","https://angular.io/docs/ts/latest/api/core/index/ClassProvider-interface.html"],[1,"text-center","clearfix"],["href","#",1,"btn","btn-primary","docs-link","pull-left",3,"routerLink"],["href","#",1,"btn","btn-primary","docs-link","pull-right",3,"routerLink"]],template:function(i,d){1&i&&(e.TgZ(0,"h2"),e._uU(1,"Persist Lists State"),e.qZA(),e.TgZ(2,"h3"),e._uU(3,"Contents"),e.qZA(),e.TgZ(4,"ul",0)(5,"li")(6,"a",1),e._uU(7,"General idea"),e.qZA()(),e.TgZ(8,"li")(9,"a",2),e._uU(10,"Examples of "),e.TgZ(11,"code"),e._uU(12,"RTStateService"),e.qZA(),e._uU(13," contract implementations"),e.qZA()(),e.TgZ(14,"li")(15,"a",3),e._uU(16,"Register and use the implemented services"),e.qZA(),e.TgZ(17,"ul")(18,"li")(19,"a",4),e._uU(20,"Register state service in the specific component"),e.qZA()(),e.TgZ(21,"li")(22,"a",5),e._uU(23,"Register state services globally"),e.qZA()()()()(),e.TgZ(24,"section",6)(25,"h3"),e._uU(26,"General idea"),e.qZA(),e.TgZ(27,"p"),e._uU(28," If you have already seen the "),e.TgZ(29,"a",7),e._uU(30,"working with filters"),e.qZA(),e._uU(31," section, you know that it is possible to annotate the properties of your component with "),e.TgZ(32,"code"),e._uU(33,"@filter"),e.qZA(),e._uU(34," decorator and configure them as data request parameters. "),e.qZA(),e.TgZ(35,"p"),e._uU(36," However, there are other possibilities of using filters: "),e.qZA(),e.TgZ(37,"ul",8)(38,"li"),e._uU(39," We can save the state of important list parameters (sortings, page size) in the "),e.TgZ(40,"code"),e._uU(41,"localStorage"),e.qZA(),e._uU(42," and restore these parameters values when user visits the page next time. "),e.qZA(),e.TgZ(43,"li"),e._uU(44," We can save the state of list parameters in "),e.TgZ(45,"code"),e._uU(46,"sessionStorage"),e.qZA(),e._uU(47," and restore them when user returns to the page during the same session. So, user gets the same list state as it is before leaving it. "),e.qZA(),e.TgZ(48,"li"),e._uU(49," We can serialize the state of all list parameters in "),e.TgZ(50,"code"),e._uU(51,"queryString"),e.qZA(),e._uU(52,". When user shares such page link, the one who opens it gets the same page state as the sender does. "),e.qZA()(),e.TgZ(53,"p"),e._uU(54," Instead of the complete implementations (as soon as the logic of saving and identifying the settings are quite specific for the end app) our library contains the contracts to support them. "),e.qZA(),e.TgZ(55,"p"),e._uU(56," Nevertheless, in this section we will show the examples of completed implementations, which will serve you as a starting point for your own ones. "),e.qZA()(),e.TgZ(57,"section",9)(58,"h3"),e._uU(59,"Examples of "),e.TgZ(60,"code"),e._uU(61,"RTStateService"),e.qZA(),e._uU(62," contract implementations"),e.qZA(),e.TgZ(63,"p"),e._uU(64," First of all, it is needed to implement the service (or services) inheriting "),e.TgZ(65,"code"),e._uU(66,"RTStateService"),e.qZA(),e._uU(67," abstract class. "),e.qZA(),e.TgZ(68,"p"),e._uU(69," The "),e.TgZ(70,"code"),e._uU(71,"getState"),e.qZA(),e._uU(72," will be called during list initialization and must return settings saved previously. "),e.qZA(),e.TgZ(73,"p"),e._uU(74," The "),e.TgZ(75,"code"),e._uU(76,"persistState"),e.qZA(),e._uU(77," method will be called by the list on every data loading. This logic works the following way: if user changes any parameters and confirms it by clicking \u201cload\u201d button, we can persist these parameters. For that we call the "),e.TgZ(78,"code"),e._uU(79,"getRequestState"),e.qZA(),e._uU(80," method of the passed "),e.TgZ(81,"code"),e._uU(82,"filtersService"),e.qZA(),e._uU(83," object and use optional delegate to filter resulted state representation by any required condition. "),e.qZA(),e.TgZ(84,"p"),e._uU(85," Below you can see the implementations of "),e.TgZ(86,"code"),e._uU(87,"RTStateService"),e.qZA(),e._uU(88," which saves the list state in "),e.TgZ(89,"code"),e._uU(90,"localStorage"),e.qZA(),e._uU(91,", "),e.TgZ(92,"code"),e._uU(93,"sessionStorage"),e.qZA(),e._uU(94,", and "),e.TgZ(95,"code"),e._uU(96,"queryString"),e.qZA(),e._uU(97,". "),e.qZA(),e.TgZ(98,"p"),e._uU(99," The implementations for "),e.TgZ(100,"code"),e._uU(101,"queryString"),e.qZA(),e._uU(102," and "),e.TgZ(103,"code"),e._uU(104,"sessionStorage"),e.qZA(),e._uU(105," save the object state entirely. "),e.qZA(),e.TgZ(106,"p"),e._uU(107," Implementation for "),e.TgZ(108,"code"),e._uU(109,"localStorage"),e.qZA(),e._uU(110," uses the possibility of the "),e.TgZ(111,"code"),e._uU(112,"getRequestState"),e.qZA(),e._uU(113," method to filter parameters and gets the states of the properties marked by the "),e.TgZ(114,"code"),e._uU(115,"@filter"),e.qZA(),e._uU(116," annotation with the "),e.TgZ(117,"code"),e._uU(118,"persistable"),e.qZA(),e._uU(119," flag. "),e.qZA(),e.TgZ(120,"p"),e._uU(121," Also this service adds the "),e.TgZ(122,"code"),e._uU(123,"take"),e.qZA(),e._uU(124," and "),e.TgZ(125,"code"),e._uU(126,"sortings"),e.qZA(),e._uU(127," properties, because they are configured at the "),e.TgZ(128,"code"),e._uU(129,"right-angled"),e.qZA(),e._uU(130," level and do not know anything about the "),e.TgZ(131,"code"),e._uU(132,"persistable"),e.qZA(),e._uU(133," flag. "),e.qZA(),e.TgZ(134,"p"),e._uU(135," As a result, the service saves only the part of list state. Well, saving such settings as page size usually is reasonable, since rarely changed by the user. But it is not necessary to save the values of the filters, because the user will probably not need the same values on every page visit. "),e.qZA(),e.TgZ(136,"rt-demo-tab-section"),e._UZ(137,"rt-demo-code-tab",10)(138,"rt-demo-code-tab",11)(139,"rt-demo-code-tab",12),e.qZA(),e.TgZ(140,"aside")(141,"p"),e._uU(142," As you can notice, the services "),e.TgZ(143,"code"),e._uU(144,"RTLocalStorageStateService"),e.qZA(),e._uU(145," and "),e.TgZ(146,"code"),e._uU(147,"RTSessionStorageStateService"),e.qZA(),e._uU(148," inject the "),e.TgZ(149,"a",13),e._uU(150,"ActivatedRoute"),e.qZA(),e._uU(151," object and implement the serialization/deserialization key based on the current routing path. "),e.qZA(),e.TgZ(152,"p"),e._uU(153," Good this solution or not depends on the requirements of the end app. For example, it can be more suitable to assign the unique key to each of the components and register such key via "),e.TgZ(154,"a",14),e._uU(155,"OpaqueToken"),e.qZA(),e._uU(156," into the component injectors. "),e.qZA()()(),e.TgZ(157,"section",15)(158,"h3"),e._uU(159,"Register and use the implemented services"),e.qZA(),e.TgZ(160,"p"),e._uU(161,"Now, we need to register the implemented services to use them in our components. We have several options to do this."),e.qZA(),e.TgZ(162,"section",16)(163,"h4"),e._uU(164,"Register state service in the specific component"),e.qZA(),e.TgZ(165,"p"),e._uU(166," The simplest way is to register implemented services as "),e.TgZ(167,"code"),e._uU(168,"RTStateService"),e.qZA(),e._uU(169," at the component level in "),e.TgZ(170,"code"),e._uU(171,"providers"),e.qZA(),e._uU(172," array. As a result the component gets all the described functionality. "),e.qZA(),e.TgZ(173,"rt-demo-tab-section")(174,"rt-demo-sample-tab"),e._UZ(175,"rt-demo-persistence-sample"),e.qZA(),e._UZ(176,"rt-demo-code-tab",17)(177,"rt-demo-code-tab",18),e.qZA()(),e.TgZ(178,"section",19)(179,"h4"),e._uU(180,"Register state services globally"),e.qZA(),e.TgZ(181,"p"),e._uU(182," It is also possible to register your services across all of the app lists. You can use "),e.TgZ(183,"code"),e._uU(184,"RTModule.registerStateService"),e.qZA(),e._uU(185," or "),e.TgZ(186,"code"),e._uU(187,"RTListModule.registerStateService"),e.qZA(),e._uU(188," and pass to it configuration object with the same settings as for angular "),e.TgZ(189,"code"),e._uU(190,"@Component"),e.qZA(),e._uU(191,' decorator "providers" option '),e.qZA(),e.TgZ(192,"rt-demo-tab-section"),e._UZ(193,"rt-demo-code-tab",20),e.qZA()(),e.TgZ(194,"aside")(195,"p"),e._uU(196," Also, it is possible to register several providers for the "),e.TgZ(197,"code"),e._uU(198,"RTStateService"),e.qZA(),e._uU(199," using "),e.TgZ(200,"a",21),e._uU(201,"flag multi"),e.qZA(),e._uU(202,". In this case, the question is: what if several providers return the values for the same parameter? "),e.qZA(),e.TgZ(203,"p"),e._uU(204," The answer is the following: the "),e.TgZ(205,"code"),e._uU(206,"getState"),e.qZA(),e._uU(207," method of registered services will be called in the same order in which you have registered your services. The resulted state will be built by the call of "),e.TgZ(208,"code"),e._uU(209,"Object.assign({}, state1, state2, ...)"),e.qZA()()()(),e.TgZ(210,"section")(211,"aside")(212,"h4"),e._uU(213,"Related sections"),e.qZA(),e.TgZ(214,"p",22)(215,"a",23),e._uU(216,"\u2190 Working with filters"),e.qZA(),e.TgZ(217,"a",24),e._uU(218,"Miscellaneous directives \u2192"),e.qZA()()()()),2&i&&(e.xp6(29),e.Q6J("routerLink",e.DdM(3,u)),e.xp6(186),e.Q6J("routerLink",e.DdM(4,u)),e.xp6(2),e.Q6J("routerLink",e.DdM(5,v)))},dependencies:[l.rH,h.E,Z.y,m.f,f],encapsulation:2,changeDetection:0})}return t})(),path:""}];let q=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=e.oAB({type:t});static#s=this.\u0275inj=e.cJS({imports:[c.ez,l.Bz.forChild(_),p.m]})}return t})()}}]);